(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[24],{"841d":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{},[a("q-header",{staticClass:"text-primary bg-white",attrs:{reveal:"","reveal-offset":10}},[a("q-toolbar",[a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"arrow_back"},on:{click:t.handleBackButton}}),a("q-toolbar-title",{staticClass:"text-weight-bold brand"},[t._v(t._s(t.title))])],1)],1),t.carts&&t.carts.length?a("div",{ref:"top",staticClass:"q-pb-xl",attrs:{id:"checkout"}},[a("q-stepper",{attrs:{"keep-alive":"",flat:"",color:"primary","alternative-labels":"",animated:""},model:{value:t.step,callback:function(e){t.step=e},expression:"step"}},[a("q-step",{attrs:{name:1,title:"Pengiriman",done:t.step>1,icon:"local_shipping"}},[a("shipping-address",{attrs:{canEmail:"",isModalAddress:t.isAvailableOldAddress},on:{place:t.placeOrder,closeModal:function(e){t.isAvailableOldAddress=!1}}})],1),"COD"!=t.form.shipping_courier_name?a("q-step",{attrs:{name:2,title:"Pembayaran",done:t.step>2,icon:"payments"}},[a("payment-list",{ref:"paymentList",attrs:{isCod:t.isCod,paymentSelected:t.paymentSelected,payments:t.paymentChanels},on:{onSelect:t.onSelectPayment}})],1):t._e(),a("q-step",{attrs:{name:3,title:"Review",done:t.step>3,icon:"playlist_add_check"}},[a("review-order",{attrs:{form:t.form,carts:t.carts,payment:t.paymentSelected,noPayment:t.isCantPaymentStep}})],1)],1)],1):t._e(),a("q-inner-loading",{attrs:{showing:t.loading}},[a("q-spinner-facebook",{attrs:{size:"50px",color:"primary"}})],1),a("div",{staticClass:"bg-white q-pa-md q-gutter-y-sm column",class:{"sticky-bottom":t.$q.platform.is.desktop}},[3!=t.step&&"COD"!=t.form.shipping_courier_name?a("q-btn",{attrs:{disabled:!t.isOk,"no-caps":"",unelevated:"",label:"Langkah Selanjutnya",color:"primary"},on:{click:t.next}}):t._e(),"COD"==t.form.shipping_courier_name&&3!=t.step?a("q-btn",{attrs:{disabled:!t.isOk,"no-caps":"",unelevated:"",label:"Langkah Selanjutnya",color:"primary"},on:{click:function(e){t.step=3}}}):t._e(),3==t.step?a("q-btn",{attrs:{disabled:t.loading,"no-caps":"",unelevated:"",label:"Proses Pesanan",color:"primary"},on:{click:t.submitOrder}}):t._e()],1)],1)},n=[],i=a("ded3"),r=a.n(i),o=(a("b0c0"),a("ac1f"),a("1276"),a("a15b"),a("159b"),a("99af"),a("5319"),a("2ca0"),a("13d5"),a("758b")),c=a("2f62"),m=a("54df"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-gutter-y-lg"},[t.isCod?a("div",[a("div",{staticClass:"q-pb-lg"},[a("fieldset",[a("legend",{staticClass:"q-px-sm"},[t._v("Bayar Ditempat")]),a("div",{staticClass:"row q-gutter-sm payment-container"},[a("div",{staticClass:"box-shadow cursor-pointer payment-list cod",class:{"is-selected":t.isSelectedCod},on:{click:t.selectCodPayment}},[a("div",{staticClass:"text-h5 text-weight-bold"},[t._v("COD")]),a("div",{staticClass:"text-center name"},[t._v("Bayar Ditempat")])])])])])]):t._e(),t.payments.localbanks.length?a("div",[a("fieldset",[a("legend",{staticClass:"q-px-sm"},[t._v("Bank Transfer")]),a("div",{staticClass:"row q-gutter-sm payment-container"},t._l(t.payments.localbanks,(function(e,s){return a("div",{key:s,staticClass:"box-shadow cursor-pointer payment-list bank_trf",class:{"is-selected":t.isSelectedBank(e.id)},on:{click:function(a){return t.selectPaymentBank(e)}}},[a("div",[a("div",{staticClass:"text-center text-weight-bold text-md"},[t._v(t._s(e.bank_name))]),a("div",{staticClass:"text-weight-medium"},[t._v("Bank Transfer")])])])})),0),a("div",{staticClass:"q-pa-sm text-caption"},[t._v("*Verifikasi manual")])])]):t._e(),t.virtualAccounts.length?a("div",[a("fieldset",[a("legend",{staticClass:"q-px-sm"},[t._v("Virtual Account")]),a("div",{staticClass:"row q-gutter-sm payment-container"},t._l(t.virtualAccounts,(function(e,s){return a("div",{key:s,staticClass:"box-shadow cursor-pointer payment-list",class:{"is-selected":t.isSelected(e.code)},on:{click:function(a){return t.selectPayment(e)}}},[a("div",{staticClass:"image"},[e.icon_url?a("img",{attrs:{src:e.icon_url}}):a("img",{attrs:{src:"/static/no-image.png"}})]),a("div",{staticClass:"text-center name"},[t._v(t._s(e.name))])])})),0)])]):t._e(),t.convenienceStore.length?a("div",[a("fieldset",[a("legend",{staticClass:"q-px-sm"},[t._v("Convenion Store")]),a("div",{staticClass:"row q-gutter-sm payment-container"},t._l(t.convenienceStore,(function(e,s){return a("div",{key:s,staticClass:"box-shadow cursor-pointer payment-list",class:{"is-selected":t.isSelected(e.code)},on:{click:function(a){return t.selectPayment(e)}}},[a("div",{staticClass:"image"},[e.icon_url?a("img",{attrs:{src:e.icon_url}}):a("img",{attrs:{src:"/static/no-image.png"}})]),a("div",{staticClass:"text-center name"},[t._v(t._s(e.name))])])})),0)])]):t._e(),t.ewalet.length?a("div",[a("fieldset",[a("legend",{staticClass:"q-px-sm"},[t._v("E-Walet")]),a("div",{staticClass:"row q-gutter-sm payment-container"},t._l(t.ewalet,(function(e,s){return a("div",{key:s,staticClass:"box-shadow cursor-pointer payment-list",class:{"is-selected":t.isSelected(e.code)},on:{click:function(a){return t.selectPayment(e)}}},[a("div",{staticClass:"image"},[e.icon_url?a("img",{attrs:{src:e.icon_url}}):a("img",{attrs:{src:"/static/no-image.png"}})]),a("div",{staticClass:"text-center name"},[t._v(t._s(e.name))])])})),0)])]):t._e()])},p=[],d=(a("4de4"),{props:{payments:Object,paymentSelected:Object,isCod:Boolean},data:function(){return{selected:null}},computed:{virtualAccounts:function(){return this.payments&&this.payments.paymentGateway.length?this.payments.paymentGateway.filter((function(t){return"Virtual Account"==t.group&&1==t.active})):[]},convenienceStore:function(){return this.payments&&this.payments.paymentGateway.length?this.payments.paymentGateway.filter((function(t){return"Convenience Store"==t.group&&1==t.active})):[]},ewalet:function(){return this.payments&&this.payments.paymentGateway.length?this.payments.paymentGateway.filter((function(t){return"E-Wallet"==t.group&&1==t.active})):[]},isSelectedCod:function(){return!!this.paymentSelected&&"COD"==this.paymentSelected.payment_type}},methods:{isSelected:function(t){return!!this.paymentSelected&&this.paymentSelected.code==t},isSelectedBank:function(t){return!!this.paymentSelected&&this.paymentSelected.id==t},selectCodPayment:function(){var t={payment_type:"COD",payment_method:"COD",payment_name:"Bayar Ditempat"};this.$emit("onSelect",t)},selectPayment:function(t){this.$emit("onSelect",r()(r()({},t),{},{payment_type:"GATEWAY"}))},selectPaymentBank:function(t){this.$emit("onSelect",r()(r()({},t),{},{payment_type:"DIRECT"}))}}}),h=d,u=a("2877"),_=Object(u["a"])(h,l,p,!1,null,null,null),y=_.exports,f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",["OVO"==t.form.payment_method?a("div",{staticClass:"q-mb-md"},[t._m(0)]):t._e(),a("fieldset",[a("legend",{staticClass:"q-pa-sm"},[t._v("Info Pengiriman")]),a("table",{staticClass:"table dense"},[a("tr",[a("th",{attrs:{align:"left"}},[t._v("Penerima")]),a("td",[t._v(":")]),a("td",[t._v(t._s(t.form.customer_name))])]),a("tr",[a("th",{attrs:{align:"left"}},[t._v("Whatsapp")]),a("td",[t._v(":")]),a("td",[t._v(t._s(t.form.customer_whatsapp))])]),a("tr",[a("th",{attrs:{align:"left"}},[t._v("Alamat")]),a("td",[t._v(":")]),a("td",[a("div",{domProps:{innerHTML:t._s(t.form.address)}})])]),a("tr",[a("th",{attrs:{align:"left"}},[t._v("Kurir")]),a("td",[t._v(":")]),a("td",[t._v(t._s(t.form.shipping_courier_name))])]),t.form.shipping_courier_service?a("tr",[a("th",{attrs:{align:"left"}},[t._v("Servis")]),a("td",[t._v(":")]),a("td",[t._v(t._s(t.form.shipping_courier_service))])]):t._e()])]),a("fieldset",{staticClass:"q-mt-lg"},[a("legend",{staticClass:"q-pa-sm"},[t._v("Ringkasan Order")]),t.carts.length?a("div",{staticClass:"bg-grey-2 q-mb-md"},[a("q-list",{attrs:{separator:""}},t._l(t.carts,(function(e){return a("q-item",{key:e.id},[a("q-item-section",{attrs:{side:"",top:""}},[a("q-img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e.image_url}})],1),a("q-item-section",[a("div",{staticClass:"col"},[a("div",{staticClass:"text-weight-bold"},[t._v(t._s(e.name))]),a("div",{staticClass:"text-grey-7"},[t._v(t._s(e.quantity+"x "+t.moneyIDR(e.price)))])])])],1)})),1)],1):t._e(),a("div",{staticClass:"flex justify-end"},[a("table",{staticClass:"table dense"},[a("tr",[a("th",{attrs:{align:"right"}},[t._v("Subtotal")]),a("td",{attrs:{align:"right"}},[t._v(":")]),a("td",{attrs:{align:"right"}},[t._v(t._s(t.moneyIDR(t.form.subtotal)))])]),a("tr",[a("th",{attrs:{align:"right"}},[t._v("Ongkos Kirim")]),a("td",{attrs:{align:"right"}},[t._v(":")]),a("td",{attrs:{align:"right"}},[t._v(t._s(t.form.shipping_cost?t.moneyIDR(t.form.shipping_cost):0))])]),a("tr",[a("th",{attrs:{align:"right"}},[t._v("Total")]),a("td",{attrs:{align:"right"}},[t._v(":")]),a("td",{attrs:{align:"right"}},[t._v(t._s(t.moneyIDR(t.form.total)))])])])])]),"COD"!=t.form.shipping_courier_name?a("fieldset",{staticClass:"q-mt-lg"},[a("legend",{staticClass:"q-pa-sm"},[t._v("Pembayaran")]),a("div",{staticClass:"row q-gutter-sm"},["COD"==t.form.payment_method?[t._m(1)]:[a("div",{staticClass:"box-shadow payment-list is-selected"},[t.payment.icon_url?a("div",{staticClass:"image"},[a("img",{attrs:{src:t.payment.icon_url}})]):t._e(),"DIRECT"==t.payment.payment_type?a("div",{staticClass:"flex justify-center items-center",staticStyle:{margin:"auto"}},[a("div",{staticClass:" text-weight-bold text-md"},[t._v(t._s(t.payment.bank_name))]),a("div",[t._v("Bank Transfer")])]):a("div",{staticClass:"text-center name"},[t._v("\n              "+t._s(t.payment.name)+"\n            ")])])]],2)]):t._e()])},g=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bg-yellow-2 text-grey-7 q-pa-sm"},[a("div",{staticClass:"text-weight-bold"},[t._v("Note:")]),a("div",[t._v("\n        Anda memilih metode pembayaran OVO, "),a("br"),t._v("Pastikan nomor ponsel dan email yang anda inputkan sama dengan yang terdaftar di OVO milik anda.\n      ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box-shadow payment-list is-selected"},[a("div",{staticClass:"text-weight-bold text-h5 text-center image"},[t._v("COD")]),a("div",{staticClass:"text-center name q-pa-xs"},[t._v("Bayar Ditempat")])])}],v={name:"ReviewOrder",props:{carts:Array,form:Object,payment:Object,noPayment:Boolean},methods:{money:function(t){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(t)}}},C=v,b=a("1c1c"),k=a("66e5"),O=a("4074"),w=a("068f"),S=a("eebe"),q=a.n(S),x=Object(u["a"])(C,f,g,!1,null,null,null),D=x.exports;q()(x,"components",{QList:b["a"],QItem:k["a"],QItemSection:O["a"],QImg:w["a"]});var P={components:{ShippingAddress:m["a"],PaymentList:y,ReviewOrder:D},name:"CheckoutPage",data:function(){return{isAvailableOldAddress:!1,isOk:!1,step1Ok:!1,step2Ok:!1,formLoading:!1,paymentChanels:{localbanks:[],paymentGateway:[]},invoiceTemp:null,step:1,paymentSelected:null,form:{reference:"",customer_name:"",customer_email:"",customer_whatsapp:"",payment_method:"",payment_name:"",payment_type:"",payment_code:"",address:"",items:[],subtotal:0,total:0,quantity:0,weight:0,shipping_courier_name:"",shipping_cost:"",shipping_courier_service:""}}},watch:{step:function(){this.checkStepOk(),this.toTop()}},computed:{isOVO:function(){return"OVO"==this.form.payment_method},isCod:function(){return"COD"==this.form.shipping_courier_name},carts:function(){return this.$store.state.cart.carts},shop:function(){return this.$store.state.shop},config:function(){return this.$store.state.config},loading:function(){return this.$store.state.loading},isCodPayment:function(){return"COD"==this.form.payment_method},isCantPaymentStep:function(){return"COD"==this.form.shipping_courier_name||!this.config.is_payment_gateway},title:function(){return 1==this.step?"Pengiriman":2==this.step?"Pembayaran":3==this.step?"Review Order":"Checkout"},session_id:function(){return this.$store.state.session_id}},mounted:function(){this.carts.length||this.$router.back(),this.config&&this.config.is_payment_gateway&&!this.paymentChanels.paymentGateway.length&&this.getPaymentChanel(),this.paymentChanels.localbanks.length||this.getLocalBanks(),this.checkDataUser()},methods:r()(r()({},Object(c["b"])("order",["storeOrder"])),{},{placeOrder:function(t){this.paymentSelected=null,"COD"==t.shipping_courier_name?(this.form.payment_type="COD",this.form.payment_method="COD",this.form.payment_name="COD"):(this.form.payment_type="",this.form.payment_method="",this.form.payment_name=""),this.form=t,this.checkStepOk()},checkDataUser:function(){localStorage.getItem("user_data")&&(this.isAvailableOldAddress=!0)},handleBackButton:function(){this.step>1?this.isCod?this.step=1:this.step-=1:this.$router.push({name:"Cart"})},toTop:function(){var t=this;setTimeout((function(){var e=t.$refs.top;e.scrollIntoView({behavior:"smooth"})}),500)},checkStepOk:function(){1==this.step?this.form.customer_name&&this.form.customer_email&&this.form.customer_whatsapp&&this.form.shipping_courier_name&&this.form.address&&(this.isCod||this.form.shipping_cost)?this.isOk=!0:this.isOk=!1:2==this.step?this.form.payment_name&&this.form.address&&this.form.payment_type?this.isOk=!0:this.isOk=!1:this.isOk=!0},onSelectPayment:function(t){this.paymentSelected=t,"DIRECT"==t.payment_type&&(this.form.payment_method="BANK_TRANSFER",this.form.payment_name=t.bank_name+" - "+t.bank_office+" ( a.n "+t.account_name+" )",this.form.payment_code=t.account_number,this.form.payment_type=t.payment_type,this.checkStepOk()),"GATEWAY"==t.payment_type&&(this.form.payment_method=t.code,this.form.payment_name=t.name,this.form.payment_code="",this.form.payment_type=t.payment_type,this.checkStepOk()),"COD"==t.payment_type&&(this.form.payment_method=t.payment_method,this.form.payment_name=t.payment_name,this.form.payment_code="",this.form.payment_type="COD",this.checkStepOk())},money:function(t){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(t)},getLocalBanks:function(){var t=this;Object(o["a"])().get("banks").then((function(e){200==e.status&&(t.paymentChanels.localbanks=e.data.results)}))},getPaymentChanel:function(){var t=this;Object(o["a"])().get("tripay/payment-chanel").then((function(e){200==e.status&&(t.paymentChanels.paymentGateway=e.data.data)}))},submitOrder:function(){var t=this;this.$store.commit("SET_LOADING",!0),this.storeOrder(this.form).then((function(e){t.$store.commit("SET_LOADING",!1),200==e.status&&(t.$store.commit("order/SET_INVOICE",e.data.results),setTimeout((function(){t.$store.dispatch("cart/clearCart",t.session_id)}),8e3),t.isCod&&t.directChekout(e.data.results),t.$router.push({name:"UserInvoice",params:{order_ref:e.data.results.order_ref}}),t.sendMessageNotification(e.data.results.order_ref))})).catch((function(){t.ready=!1,t.$store.commit("SET_LOADING",!1)}))},sendMessageNotification:function(t){var e=this;setTimeout((function(){Object(o["a"])().post("sendNotify",{url:e.getRoutePath(t),order_ref:t})}),12e3)},formatAddressCod:function(t){var e=t.split("<br>");return e.join("\n")},directChekout:function(t){var e=this,a="https://api.whatsapp.com",s=this.formatPhoneNumber(this.shop.phone),n="Halo kak, saya mau order:\n\n",i=t.items,r=1;i.forEach((function(t){n+="*".concat(r,". ").concat(t.name,"*\nJumlah: ").concat(t.quantity,"\nHarga (@): ").concat(e.moneyIDR(t.price),"\nHarga Total: ").concat(e.moneyIDR(t.quantity*t.price),"\n\n"),r++})),n+="Subtotal: *".concat(this.moneyIDR(t.order_subtotal),"*\nOngkir (Diantar): *Rp 0*\nTotal: *").concat(this.moneyIDR(t.order_total),"*\n------------------------\n\n*Nama:*\n ").concat(t.customer_name," (").concat(t.customer_whatsapp,")\n\n*Alamat:*\n").concat(this.formatAddressCod(t.shipping_address),"\n\n"),n+="Metode Pembayaran: ".concat(t.transaction.payment_name,"\n\n"),n+="Referensi Order:\n".concat(this.getRoutePath(t.order_ref));var o=a+"/send?phone="+s+"&text="+encodeURI(n);window.open(o,"_blank")},formatPhoneNumber:function(t){var e=t.replace(/\D/g,"");return e.startsWith("0")&&(e="62"+e.substr(1)),e},getRoutePath:function(t){var e=this.$router.resolve({name:"UserInvoice",params:{order_ref:t}});return location.origin+e.href},next:function(){this.isCod?this.step=3:this.step+=1},prev:function(){this.isCod?this.step=1:this.step-=1},subtotal:function(){if(this.carts.length>1){var t=[];return this.carts.forEach((function(e){t.push(e.quantity*e.price)})),t.reduce((function(t,e){return t+e}))}return this.carts[0].quantity*this.carts[0].price},total:function(){return this.subtotal()}}),meta:function(){return{title:"Checkout"}}},I=P,A=a("9989"),R=a("e359"),T=a("65c6"),$=a("9c40"),B=a("6ac5"),E=a("f531"),j=a("87fe"),N=a("74f7"),G=a("e669"),L=Object(u["a"])(I,s,n,!1,null,null,null);e["default"]=L.exports;q()(L,"components",{QPage:A["a"],QHeader:R["a"],QToolbar:T["a"],QBtn:$["a"],QToolbarTitle:B["a"],QStepper:E["a"],QStep:j["a"],QInnerLoading:N["a"],QSpinnerFacebook:G["a"]})}}]);